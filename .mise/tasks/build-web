#!/bin/bash
#MISE description="Build the web lambda binary"
echo "Building Web..."

# Create a temporary directory for the build artifact
WORK_DIR=$(mktemp -d)
trap 'rm -rf "$WORK_DIR"' EXIT

# Build the binary named 'bootstrap' into the temp dir
GOOS=linux GOARCH=arm64 go build -o "$WORK_DIR/bootstrap" cmd/web/main.go

# Zip the bootstrap file into web.zip in the current directory
# -j (junk paths) ensures the file is stored as just "bootstrap" at the root of the zip
zip -j web.zip "$WORK_DIR/bootstrap"
